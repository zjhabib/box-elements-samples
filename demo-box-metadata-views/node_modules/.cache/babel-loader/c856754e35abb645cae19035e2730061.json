{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\n/**\n * \n * @file Item List Key bindings\n * @author Box\n */\nimport React, { PureComponent } from 'react';\nimport noop from 'lodash/noop';\nimport { isInputElement } from '../../utils/dom';\nvar KeyBinder = /*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(KeyBinder, _PureComponent);\n  _createClass(KeyBinder, null, [{\n    key: \"getDerivedStateFromProps\",\n    /**\n     * Resets scroll position if props change\n     * @private\n     * @inheritdoc\n     * @return {State|null}\n     */\n    value: function getDerivedStateFromProps(props, state) {\n      var prevId = state.prevId,\n        prevScrollToColumn = state.prevScrollToColumn,\n        prevScrollToRow = state.prevScrollToRow;\n      var id = props.id,\n        scrollToColumnProp = props.scrollToColumn,\n        scrollToRowProp = props.scrollToRow;\n      if (id !== prevId) {\n        return {\n          focusOnRender: false,\n          prevId: id,\n          prevScrollToColumn: 0,\n          prevScrollToRow: 0,\n          scrollToColumn: 0,\n          scrollToRow: 0\n        };\n      }\n      var newState = {};\n      if (prevScrollToColumn !== scrollToColumnProp && prevScrollToRow !== scrollToRowProp) {\n        newState.prevScrollToColumn = scrollToColumnProp;\n        newState.prevScrollToRow = scrollToRowProp;\n        newState.scrollToColumn = scrollToColumnProp;\n        newState.scrollToRow = scrollToRowProp;\n      } else if (scrollToRowProp !== prevScrollToRow) {\n        newState.prevScrollToRow = scrollToRowProp;\n        newState.scrollToRow = scrollToRowProp;\n      } else if (scrollToColumnProp !== prevScrollToColumn) {\n        newState.prevScrollToColumn = scrollToColumnProp;\n        newState.scrollToColumn = scrollToColumnProp;\n      }\n      return Object.keys(newState).length ? newState : null;\n    }\n    /**\n     * [constructor]\n     *\n     * @private\n     * @return {KeyBinder}\n     */\n  }]);\n\n  function KeyBinder(props) {\n    var _this;\n    _classCallCheck(this, KeyBinder);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(KeyBinder).call(this, props));\n    _defineProperty(_assertThisInitialized(_this), \"onKeyDown\", function (event) {\n      if (isInputElement(event.target)) {\n        return;\n      }\n      var _this$props = _this.props,\n        columnCount = _this$props.columnCount,\n        rowCount = _this$props.rowCount,\n        onSelect = _this$props.onSelect,\n        onRename = _this$props.onRename,\n        onDownload = _this$props.onDownload,\n        onShare = _this$props.onShare,\n        onDelete = _this$props.onDelete,\n        onOpen = _this$props.onOpen,\n        items = _this$props.items;\n      var _this$state = _this.state,\n        scrollToColumnPrevious = _this$state.scrollToColumn,\n        scrollToRowPrevious = _this$state.scrollToRow;\n      var _this$state2 = _this.state,\n        scrollToColumn = _this$state2.scrollToColumn,\n        scrollToRow = _this$state2.scrollToRow;\n      var currentItem = items[scrollToRow];\n      var ctrlMeta = event.metaKey || event.ctrlKey; // The above cases all prevent default event event behavior.\n      // This is to keep the grid from scrolling after the snap-to update.\n\n      switch (event.key) {\n        case 'ArrowDown':\n          scrollToRow = ctrlMeta ? rowCount - 1 : Math.min(scrollToRow + 1, rowCount - 1);\n          event.stopPropagation(); // To prevent the arrow down capture of parent\n\n          break;\n        case 'ArrowLeft':\n          scrollToColumn = ctrlMeta ? 0 : Math.max(scrollToColumn - 1, 0);\n          break;\n        case 'ArrowRight':\n          scrollToColumn = ctrlMeta ? columnCount - 1 : Math.min(scrollToColumn + 1, columnCount - 1);\n          break;\n        case 'ArrowUp':\n          scrollToRow = ctrlMeta ? 0 : Math.max(scrollToRow - 1, 0);\n          break;\n        case 'Enter':\n          onOpen(currentItem);\n          event.preventDefault();\n          break;\n        case 'Delete':\n          onDelete(currentItem);\n          event.preventDefault();\n          break;\n        case 'X':\n          onSelect(currentItem);\n          event.preventDefault();\n          break;\n        case 'D':\n          onDownload(currentItem);\n          event.preventDefault();\n          break;\n        case 'S':\n          onShare(currentItem);\n          event.preventDefault();\n          break;\n        case 'R':\n          onRename(currentItem);\n          event.preventDefault();\n          break;\n        default:\n          return;\n      }\n      if (scrollToColumn !== scrollToColumnPrevious || scrollToRow !== scrollToRowPrevious) {\n        event.preventDefault();\n        _this.updateScrollState({\n          scrollToColumn: scrollToColumn,\n          scrollToRow: scrollToRow\n        });\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onSectionRendered\", function (_ref) {\n      var columnStartIndex = _ref.columnStartIndex,\n        columnStopIndex = _ref.columnStopIndex,\n        rowStartIndex = _ref.rowStartIndex,\n        rowStopIndex = _ref.rowStopIndex;\n      _this.columnStartIndex = columnStartIndex;\n      _this.columnStopIndex = columnStopIndex;\n      _this.rowStartIndex = rowStartIndex;\n      _this.rowStopIndex = rowStopIndex;\n    });\n    var id = props.id,\n      _scrollToRow = props.scrollToRow,\n      _scrollToColumn = props.scrollToColumn;\n    _this.state = {\n      focusOnRender: false,\n      prevId: id,\n      prevScrollToColumn: _scrollToColumn,\n      prevScrollToRow: _scrollToRow,\n      scrollToColumn: _scrollToColumn,\n      scrollToRow: _scrollToRow\n    };\n    _this.columnStartIndex = 0;\n    _this.columnStopIndex = 0;\n    _this.rowStartIndex = 0;\n    _this.rowStopIndex = 0;\n    return _this;\n  }\n  /**\n   * Keyboard events\n   *\n   * @private\n   * @inheritdoc\n   * @return {void}\n   */\n\n  _createClass(KeyBinder, [{\n    key: \"updateScrollState\",\n    /**\n     * Updates the scroll states\n     *\n     * @private\n     * @inheritdoc\n     * @return {void}\n     */\n    value: function updateScrollState(_ref2) {\n      var scrollToColumn = _ref2.scrollToColumn,\n        scrollToRow = _ref2.scrollToRow;\n      var onScrollToChange = this.props.onScrollToChange;\n      onScrollToChange({\n        scrollToColumn: scrollToColumn,\n        scrollToRow: scrollToRow\n      });\n      this.setState({\n        scrollToColumn: scrollToColumn,\n        scrollToRow: scrollToRow,\n        focusOnRender: true\n      });\n    }\n    /**\n     * Renders the HOC\n     *\n     * @private\n     * @inheritdoc\n     * @return {void}\n     */\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n        className = _this$props2.className,\n        children = _this$props2.children;\n      var _this$state3 = this.state,\n        scrollToColumn = _this$state3.scrollToColumn,\n        scrollToRow = _this$state3.scrollToRow,\n        focusOnRender = _this$state3.focusOnRender;\n      /* eslint-disable jsx-a11y/no-static-element-interactions */\n\n      return React.createElement(\"div\", {\n        className: className,\n        onKeyDown: this.onKeyDown\n      }, children({\n        onSectionRendered: this.onSectionRendered,\n        scrollToColumn: scrollToColumn,\n        scrollToRow: scrollToRow,\n        focusOnRender: focusOnRender\n      }));\n      /* eslint-enable jsx-a11y/no-static-element-interactions */\n    }\n  }]);\n\n  return KeyBinder;\n}(PureComponent);\n_defineProperty(KeyBinder, \"defaultProps\", {\n  scrollToColumn: 0,\n  scrollToRow: 0,\n  onRename: noop,\n  onShare: noop,\n  onDownload: noop,\n  onOpen: noop,\n  onSelect: noop,\n  onDelete: noop\n});\nexport default KeyBinder;","map":{"version":3,"sources":["../../../src/elements/common/KeyBinder.js"],"names":["React","PureComponent","noop","isInputElement","KeyBinder","scrollToColumn","scrollToRow","onRename","onShare","onDownload","onOpen","onSelect","onDelete","props","state","prevId","prevScrollToColumn","prevScrollToRow","id","scrollToColumnProp","scrollToRowProp","focusOnRender","newState","Object","keys","length","columnStartIndex","columnStopIndex","rowStartIndex","rowStopIndex","event","target","columnCount","rowCount","items","scrollToColumnPrevious","scrollToRowPrevious","currentItem","ctrlMeta","metaKey","ctrlKey","key","Math","min","stopPropagation","max","preventDefault","updateScrollState","onScrollToChange","setState","className","children","onKeyDown","onSectionRendered"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;AAMA,OAAOA,KAAP,IAAgBC,aAAhB,QAAqC,OAArC;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,SAASC,cAAT,QAA+B,iBAA/B;IA8BMC,S;;;;;IAwBF;;;;;;6CAMgCS,K,EAAcC,K,EAAc;MAAA,IAChDC,MADgD,GACOD,KADP,CAChDC,MADgD;QACxCC,kBADwC,GACOF,KADP,CACxCE,kBADwC;QACpBC,eADoB,GACOH,KADP,CACpBG,eADoB;MAAA,IAEhDC,EAFgD,GAEgCL,KAFhC,CAEhDK,EAFgD;QAE5BC,kBAF4B,GAEgCN,KAFhC,CAE5CR,cAF4C;QAEKe,eAFL,GAEgCP,KAFhC,CAERP,WAFQ;MAIxD,IAAIY,EAAE,KAAKH,MAAX,EAAmB;QACf,OAAO;UACHM,aAAa,EAAE,KADZ;UAEHN,MAAM,EAAEG,EAFL;UAGHF,kBAAkB,EAAE,CAHjB;UAIHC,eAAe,EAAE,CAJd;UAKHZ,cAAc,EAAE,CALb;UAMHC,WAAW,EAAE;QANV,CAAP;MAQH;MAED,IAAMgB,QAAQ,GAAG,CAAA,CAAjB;MAEA,IAAIN,kBAAkB,KAAKG,kBAAvBH,IAA6CC,eAAe,KAAKG,eAArE,EAAsF;QAClFE,QAAQ,CAACN,kBAATM,GAA8BH,kBAA9BG;QACAA,QAAQ,CAACL,eAATK,GAA2BF,eAA3BE;QACAA,QAAQ,CAACjB,cAATiB,GAA0BH,kBAA1BG;QACAA,QAAQ,CAAChB,WAATgB,GAAuBF,eAAvBE;MACH,CALD,MAKO,IAAIF,eAAe,KAAKH,eAAxB,EAAyC;QAC5CK,QAAQ,CAACL,eAATK,GAA2BF,eAA3BE;QACAA,QAAQ,CAAChB,WAATgB,GAAuBF,eAAvBE;MACH,CAHM,MAGA,IAAIH,kBAAkB,KAAKH,kBAA3B,EAA+C;QAClDM,QAAQ,CAACN,kBAATM,GAA8BH,kBAA9BG;QACAA,QAAQ,CAACjB,cAATiB,GAA0BH,kBAA1BG;MACH;MAED,OAAOC,MAAM,CAACC,IAAPD,CAAYD,QAAZC,CAAAA,CAAsBE,MAAtBF,GAA+BD,QAA/BC,GAA0C,IAAjD;IACH;IAED;;;;;;;;EAMA,SAAA,SAAA,CAAYV,KAAZ,EAA0B;IAAA,IAAA,KAAA;IAAA,eAAA,CAAA,IAAA,EAAA,SAAA,CAAA;IACtB,KAAA,GAAA,0BAAA,CAAA,IAAA,EAAA,eAAA,CAAA,SAAA,CAAA,CAAA,IAAA,CAAA,IAAA,EAAMA,KAAN,CAAA,CAAA;IADsB,eAAA,CAAA,sBAAA,CAAA,KAAA,CAAA,EAAA,WAAA,EA0Bd,UAACiB,KAAD,EAAgD;MACxD,IAAI3B,cAAc,CAAC2B,KAAK,CAACC,MAAP,CAAlB,EAAkC;QAC9B;MACH;MAHuD,IAAA,WAAA,GAe7C,KAAA,CAAKlB,KAfwC;QAMpDmB,WANoD,GAAA,WAAA,CAMpDA,WANoD;QAOpDC,QAPoD,GAAA,WAAA,CAOpDA,QAPoD;QAQpDtB,QARoD,GAAA,WAAA,CAQpDA,QARoD;QASpDJ,QAToD,GAAA,WAAA,CASpDA,QAToD;QAUpDE,UAVoD,GAAA,WAAA,CAUpDA,UAVoD;QAWpDD,OAXoD,GAAA,WAAA,CAWpDA,OAXoD;QAYpDI,QAZoD,GAAA,WAAA,CAYpDA,QAZoD;QAapDF,MAboD,GAAA,WAAA,CAapDA,MAboD;QAcpDwB,KAdoD,GAAA,WAAA,CAcpDA,KAdoD;MAAA,IAAA,WAAA,GAgBoC,KAAA,CAAKpB,KAhBzC;QAgBhCqB,sBAhBgC,GAAA,WAAA,CAgBhD9B,cAhBgD;QAgBK+B,mBAhBL,GAAA,WAAA,CAgBR9B,WAhBQ;MAAA,IAAA,YAAA,GAiBX,KAAA,CAAKQ,KAjBM;QAiBlDT,cAjBkD,GAAA,YAAA,CAiBlDA,cAjBkD;QAiBlCC,WAjBkC,GAAA,YAAA,CAiBlCA,WAjBkC;MAkBxD,IAAM+B,WAAoB,GAAGH,KAAK,CAAC5B,WAAD,CAAlC;MACA,IAAMgC,QAAiB,GAAGR,KAAK,CAACS,OAANT,IAAiBA,KAAK,CAACU,OAAjD,CAnBwD,CAqBxD;MACA;;MACA,QAAQV,KAAK,CAACW,GAAd;QACI,KAAK,WAAL;UACInC,WAAW,GAAGgC,QAAQ,GAAGL,QAAQ,GAAG,CAAd,GAAkBS,IAAI,CAACC,GAALD,CAASpC,WAAW,GAAG,CAAvBoC,EAA0BT,QAAQ,GAAG,CAArCS,CAAxCpC;UACAwB,KAAK,CAACc,eAANd,CAAAA,CAAAA,CAFJ,CAE6B;;UACzB;QACJ,KAAK,WAAL;UACIzB,cAAc,GAAGiC,QAAQ,GAAG,CAAH,GAAOI,IAAI,CAACG,GAALH,CAASrC,cAAc,GAAG,CAA1BqC,EAA6B,CAA7BA,CAAhCrC;UACA;QACJ,KAAK,YAAL;UACIA,cAAc,GAAGiC,QAAQ,GAAGN,WAAW,GAAG,CAAjB,GAAqBU,IAAI,CAACC,GAALD,CAASrC,cAAc,GAAG,CAA1BqC,EAA6BV,WAAW,GAAG,CAA3CU,CAA9CrC;UACA;QACJ,KAAK,SAAL;UACIC,WAAW,GAAGgC,QAAQ,GAAG,CAAH,GAAOI,IAAI,CAACG,GAALH,CAASpC,WAAW,GAAG,CAAvBoC,EAA0B,CAA1BA,CAA7BpC;UACA;QACJ,KAAK,OAAL;UACII,MAAM,CAAC2B,WAAD,CAAN3B;UACAoB,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;UACA;QACJ,KAAK,QAAL;UACIlB,QAAQ,CAACyB,WAAD,CAARzB;UACAkB,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;UACA;QACJ,KAAK,GAAL;UACInB,QAAQ,CAAC0B,WAAD,CAAR1B;UACAmB,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;UACA;QACJ,KAAK,GAAL;UACIrB,UAAU,CAAC4B,WAAD,CAAV5B;UACAqB,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;UACA;QACJ,KAAK,GAAL;UACItB,OAAO,CAAC6B,WAAD,CAAP7B;UACAsB,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;UACA;QACJ,KAAK,GAAL;UACIvB,QAAQ,CAAC8B,WAAD,CAAR9B;UACAuB,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;UACA;QACJ;UACI;MAvCR;MA0CA,IAAIzB,cAAc,KAAK8B,sBAAnB9B,IAA6CC,WAAW,KAAK8B,mBAAjE,EAAsF;QAClFN,KAAK,CAACgB,cAANhB,CAAAA,CAAAA;QACA,KAAA,CAAKiB,iBAAL,CAAuB;UAAE1C,cAAc,EAAdA,cAAF;UAAkBC,WAAW,EAAXA;QAAlB,CAAvB,CAAA;MACH;IACJ,CA/FyB,CAAA;IAAA,eAAA,CAAA,sBAAA,CAAA,KAAA,CAAA,EAAA,mBAAA,EAwGN,UAAA,IAAA,EAUR;MAAA,IATRoB,gBASQ,GAAA,IAAA,CATRA,gBASQ;QARRC,eAQQ,GAAA,IAAA,CARRA,eAQQ;QAPRC,aAOQ,GAAA,IAAA,CAPRA,aAOQ;QANRC,YAMQ,GAAA,IAAA,CANRA,YAMQ;MACR,KAAA,CAAKH,gBAAL,GAAwBA,gBAAxB;MACA,KAAA,CAAKC,eAAL,GAAuBA,eAAvB;MACA,KAAA,CAAKC,aAAL,GAAqBA,aAArB;MACA,KAAA,CAAKC,YAAL,GAAoBA,YAApB;IACH,CAvHyB,CAAA;IAAA,IAGdX,EAHc,GAG6BL,KAH7B,CAGdK,EAHc;MAGVZ,YAHU,GAG6BO,KAH7B,CAGVP,WAHU;MAGGD,eAHH,GAG6BQ,KAH7B,CAGGR,cAHH;IAItB,KAAA,CAAKS,KAAL,GAAa;MACTO,aAAa,EAAE,KADN;MAETN,MAAM,EAAEG,EAFC;MAGTF,kBAAkB,EAAEX,eAHX;MAITY,eAAe,EAAEX,YAJR;MAKTD,cAAc,EAAdA,eALS;MAMTC,WAAW,EAAXA;IANS,CAAb;IASA,KAAA,CAAKoB,gBAAL,GAAwB,CAAxB;IACA,KAAA,CAAKC,eAAL,GAAuB,CAAvB;IACA,KAAA,CAAKC,aAAL,GAAqB,CAArB;IACA,KAAA,CAAKC,YAAL,GAAoB,CAApB;IAhBsB,OAAA,KAAA;EAiBzB;EAED;;;;;;;;;;IAsGA;;;;;;;6CAO0G;MAAA,IAAtFxB,cAAsF,GAAA,KAAA,CAAtFA,cAAsF;QAAtEC,WAAsE,GAAA,KAAA,CAAtEA,WAAsE;MAAA,IAC9F0C,gBAD8F,GACzE,IAAA,CAAKnC,KADoE,CAC9FmC,gBAD8F;MAEtGA,gBAAgB,CAAC;QAAE3C,cAAc,EAAdA,cAAF;QAAkBC,WAAW,EAAXA;MAAlB,CAAD,CAAhB0C;MACA,IAAA,CAAKC,QAAL,CAAc;QAAE5C,cAAc,EAAdA,cAAF;QAAkBC,WAAW,EAAXA,WAAlB;QAA+Be,aAAa,EAAE;MAA9C,CAAd,CAAA;IACH;IAED;;;;;;;;;6BAOS;MAAA,IAAA,YAAA,GAC2B,IAAA,CAAKR,KADhC;QACGqC,SADH,GAAA,YAAA,CACGA,SADH;QACcC,QADd,GAAA,YAAA,CACcA,QADd;MAAA,IAAA,YAAA,GAEyD,IAAA,CAAKrC,KAF9D;QAEGT,cAFH,GAAA,YAAA,CAEGA,cAFH;QAEmBC,WAFnB,GAAA,YAAA,CAEmBA,WAFnB;QAEgCe,aAFhC,GAAA,YAAA,CAEgCA,aAFhC;MAIL;;MACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;QAAK,SAAS,EAAE6B,SAAhB;QAA2B,SAAS,EAAE,IAAA,CAAKE;MAA3C,CAAA,EACKD,QAAQ,CAAC;QACNE,iBAAiB,EAAE,IAAA,CAAKA,iBADlB;QAENhD,cAAc,EAAdA,cAFM;QAGNC,WAAW,EAAXA,WAHM;QAINe,aAAa,EAAbA;MAJM,CAAD,CADb,CADJ;MAUA;IACH;;;;EAlOmBpB,a;gBAAlBG,S,kBAaoB;EAClBC,cAAc,EAAE,CADE;EAElBC,WAAW,EAAE,CAFK;EAGlBC,QAAQ,EAAEL,IAHQ;EAIlBM,OAAO,EAAEN,IAJS;EAKlBO,UAAU,EAAEP,IALM;EAMlBQ,MAAM,EAAER,IANU;EAOlBS,QAAQ,EAAET,IAPQ;EAQlBU,QAAQ,EAAEV;AARQ,C;AAwN1B,eAAeE,SAAf","sourcesContent":["/**\n * @flow\n * @file Item List Key bindings\n * @author Box\n */\n\nimport React, { PureComponent } from 'react';\nimport noop from 'lodash/noop';\nimport { isInputElement } from '../../utils/dom';\nimport type { BoxItem } from '../../common/types/core';\n\ntype Props = {\n    children: Function,\n    className: string,\n    columnCount: number,\n    id: string | void,\n    items: BoxItem[],\n    onDelete: Function,\n    onDownload: Function,\n    onOpen: Function,\n    onRename: Function,\n    onScrollToChange: Function,\n    onSelect: Function,\n    onShare: Function,\n    rowCount: number,\n    scrollToColumn: number,\n    scrollToRow: number,\n};\n\ntype State = {\n    focusOnRender: boolean,\n    prevId: string | void,\n    prevScrollToColumn: number,\n    prevScrollToRow: number,\n    scrollToColumn: number,\n    scrollToRow: number,\n};\n\nclass KeyBinder extends PureComponent<Props, State> {\n    state: State;\n\n    props: Props;\n\n    columnStartIndex: number;\n\n    columnStopIndex: number;\n\n    rowStartIndex: number;\n\n    rowStopIndex: number;\n\n    static defaultProps = {\n        scrollToColumn: 0,\n        scrollToRow: 0,\n        onRename: noop,\n        onShare: noop,\n        onDownload: noop,\n        onOpen: noop,\n        onSelect: noop,\n        onDelete: noop,\n    };\n\n    /**\n     * Resets scroll position if props change\n     * @private\n     * @inheritdoc\n     * @return {State|null}\n     */\n    static getDerivedStateFromProps(props: Props, state: State) {\n        const { prevId, prevScrollToColumn, prevScrollToRow }: State = state;\n        const { id, scrollToColumn: scrollToColumnProp, scrollToRow: scrollToRowProp }: Props = props;\n\n        if (id !== prevId) {\n            return {\n                focusOnRender: false,\n                prevId: id,\n                prevScrollToColumn: 0,\n                prevScrollToRow: 0,\n                scrollToColumn: 0,\n                scrollToRow: 0,\n            };\n        }\n\n        const newState = {};\n\n        if (prevScrollToColumn !== scrollToColumnProp && prevScrollToRow !== scrollToRowProp) {\n            newState.prevScrollToColumn = scrollToColumnProp;\n            newState.prevScrollToRow = scrollToRowProp;\n            newState.scrollToColumn = scrollToColumnProp;\n            newState.scrollToRow = scrollToRowProp;\n        } else if (scrollToRowProp !== prevScrollToRow) {\n            newState.prevScrollToRow = scrollToRowProp;\n            newState.scrollToRow = scrollToRowProp;\n        } else if (scrollToColumnProp !== prevScrollToColumn) {\n            newState.prevScrollToColumn = scrollToColumnProp;\n            newState.scrollToColumn = scrollToColumnProp;\n        }\n\n        return Object.keys(newState).length ? newState : null;\n    }\n\n    /**\n     * [constructor]\n     *\n     * @private\n     * @return {KeyBinder}\n     */\n    constructor(props: Props) {\n        super(props);\n\n        const { id, scrollToRow, scrollToColumn }: Props = props;\n        this.state = {\n            focusOnRender: false,\n            prevId: id,\n            prevScrollToColumn: scrollToColumn,\n            prevScrollToRow: scrollToRow,\n            scrollToColumn,\n            scrollToRow,\n        };\n\n        this.columnStartIndex = 0;\n        this.columnStopIndex = 0;\n        this.rowStartIndex = 0;\n        this.rowStopIndex = 0;\n    }\n\n    /**\n     * Keyboard events\n     *\n     * @private\n     * @inheritdoc\n     * @return {void}\n     */\n    onKeyDown = (event: SyntheticKeyboardEvent<HTMLElement>) => {\n        if (isInputElement(event.target)) {\n            return;\n        }\n\n        const {\n            columnCount,\n            rowCount,\n            onSelect,\n            onRename,\n            onDownload,\n            onShare,\n            onDelete,\n            onOpen,\n            items,\n        }: Props = this.props;\n        const { scrollToColumn: scrollToColumnPrevious, scrollToRow: scrollToRowPrevious }: State = this.state;\n        let { scrollToColumn, scrollToRow }: State = this.state;\n        const currentItem: BoxItem = items[scrollToRow];\n        const ctrlMeta: boolean = event.metaKey || event.ctrlKey;\n\n        // The above cases all prevent default event event behavior.\n        // This is to keep the grid from scrolling after the snap-to update.\n        switch (event.key) {\n            case 'ArrowDown':\n                scrollToRow = ctrlMeta ? rowCount - 1 : Math.min(scrollToRow + 1, rowCount - 1);\n                event.stopPropagation(); // To prevent the arrow down capture of parent\n                break;\n            case 'ArrowLeft':\n                scrollToColumn = ctrlMeta ? 0 : Math.max(scrollToColumn - 1, 0);\n                break;\n            case 'ArrowRight':\n                scrollToColumn = ctrlMeta ? columnCount - 1 : Math.min(scrollToColumn + 1, columnCount - 1);\n                break;\n            case 'ArrowUp':\n                scrollToRow = ctrlMeta ? 0 : Math.max(scrollToRow - 1, 0);\n                break;\n            case 'Enter':\n                onOpen(currentItem);\n                event.preventDefault();\n                break;\n            case 'Delete':\n                onDelete(currentItem);\n                event.preventDefault();\n                break;\n            case 'X':\n                onSelect(currentItem);\n                event.preventDefault();\n                break;\n            case 'D':\n                onDownload(currentItem);\n                event.preventDefault();\n                break;\n            case 'S':\n                onShare(currentItem);\n                event.preventDefault();\n                break;\n            case 'R':\n                onRename(currentItem);\n                event.preventDefault();\n                break;\n            default:\n                return;\n        }\n\n        if (scrollToColumn !== scrollToColumnPrevious || scrollToRow !== scrollToRowPrevious) {\n            event.preventDefault();\n            this.updateScrollState({ scrollToColumn, scrollToRow });\n        }\n    };\n\n    /**\n     * Callback for set of rows rendered\n     *\n     * @private\n     * @inheritdoc\n     * @return {void}\n     */\n    onSectionRendered = ({\n        columnStartIndex,\n        columnStopIndex,\n        rowStartIndex,\n        rowStopIndex,\n    }: {\n        columnStartIndex: number,\n        columnStopIndex: number,\n        rowStartIndex: number,\n        rowStopIndex: number,\n    }): void => {\n        this.columnStartIndex = columnStartIndex;\n        this.columnStopIndex = columnStopIndex;\n        this.rowStartIndex = rowStartIndex;\n        this.rowStopIndex = rowStopIndex;\n    };\n\n    /**\n     * Updates the scroll states\n     *\n     * @private\n     * @inheritdoc\n     * @return {void}\n     */\n    updateScrollState({ scrollToColumn, scrollToRow }: { scrollToColumn: number, scrollToRow: number }): void {\n        const { onScrollToChange } = this.props;\n        onScrollToChange({ scrollToColumn, scrollToRow });\n        this.setState({ scrollToColumn, scrollToRow, focusOnRender: true });\n    }\n\n    /**\n     * Renders the HOC\n     *\n     * @private\n     * @inheritdoc\n     * @return {void}\n     */\n    render() {\n        const { className, children } = this.props;\n        const { scrollToColumn, scrollToRow, focusOnRender }: State = this.state;\n\n        /* eslint-disable jsx-a11y/no-static-element-interactions */\n        return (\n            <div className={className} onKeyDown={this.onKeyDown}>\n                {children({\n                    onSectionRendered: this.onSectionRendered,\n                    scrollToColumn,\n                    scrollToRow,\n                    focusOnRender,\n                })}\n            </div>\n        );\n        /* eslint-enable jsx-a11y/no-static-element-interactions */\n    }\n}\n\nexport default KeyBinder;\n"]},"metadata":{},"sourceType":"module"}