{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nimport * as React from 'react';\nimport noop from 'lodash/noop';\nimport LoadingIndicator from '../../../../../components/loading-indicator';\nimport formatTaggedMessage from '../../utils/formatTaggedMessage';\nimport ShowOriginalButton from './ShowOriginalButton';\nimport TranslateButton from './TranslateButton';\nimport './ActivityMessage.scss';\nvar ActivityMessage = /*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ActivityMessage, _React$Component);\n  function ActivityMessage() {\n    var _getPrototypeOf2;\n    var _this;\n    _classCallCheck(this, ActivityMessage);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ActivityMessage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      isLoading: false,\n      isTranslation: false\n    });\n    _defineProperty(_assertThisInitialized(_this), \"handleTranslate\", function (event) {\n      var _this$props = _this.props,\n        id = _this$props.id,\n        tagged_message = _this$props.tagged_message,\n        _this$props$onTransla = _this$props.onTranslate,\n        onTranslate = _this$props$onTransla === void 0 ? noop : _this$props$onTransla,\n        translatedTaggedMessage = _this$props.translatedTaggedMessage;\n      if (!translatedTaggedMessage) {\n        _this.setState({\n          isLoading: true\n        });\n        onTranslate({\n          id: id,\n          tagged_message: tagged_message\n        });\n      }\n      _this.setState({\n        isTranslation: true\n      });\n      event.preventDefault();\n    });\n    _defineProperty(_assertThisInitialized(_this), \"handleShowOriginal\", function (event) {\n      _this.setState({\n        isTranslation: false\n      });\n      event.preventDefault();\n    });\n    return _this;\n  }\n  _createClass(ActivityMessage, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this$props2 = this.props,\n        translatedTaggedMessage = _this$props2.translatedTaggedMessage,\n        translationFailed = _this$props2.translationFailed;\n      var prevTaggedMessage = prevProps.translatedTaggedMessage,\n        prevTranslationFailed = prevProps.translationFailed;\n      if (prevTaggedMessage === translatedTaggedMessage || prevTranslationFailed === translationFailed) {\n        return;\n      }\n      if (translatedTaggedMessage || translationFailed) {\n        this.setState({\n          isLoading: false\n        });\n      }\n    }\n  }, {\n    key: \"getButton\",\n    value: function getButton(isTranslation) {\n      var button = null;\n      if (isTranslation) {\n        button = React.createElement(ShowOriginalButton, {\n          handleShowOriginal: this.handleShowOriginal\n        });\n      } else {\n        button = React.createElement(TranslateButton, {\n          handleTranslate: this.handleTranslate\n        });\n      }\n      return button;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n        id = _this$props3.id,\n        tagged_message = _this$props3.tagged_message,\n        translatedTaggedMessage = _this$props3.translatedTaggedMessage,\n        translationEnabled = _this$props3.translationEnabled,\n        getUserProfileUrl = _this$props3.getUserProfileUrl;\n      var _this$state = this.state,\n        isLoading = _this$state.isLoading,\n        isTranslation = _this$state.isTranslation;\n      var commentToDisplay = translationEnabled && isTranslation && translatedTaggedMessage ? translatedTaggedMessage : tagged_message;\n      return isLoading ? React.createElement(\"div\", {\n        className: \"bcs-ActivityMessageLoading\"\n      }, React.createElement(LoadingIndicator, {\n        size: \"small\"\n      })) : React.createElement(\"div\", {\n        className: \"bcs-ActivityMessage\"\n      }, formatTaggedMessage(commentToDisplay, id, false, getUserProfileUrl), translationEnabled ? this.getButton(isTranslation) : null);\n    }\n  }]);\n  return ActivityMessage;\n}(React.Component);\n_defineProperty(ActivityMessage, \"defaultProps\", {\n  translationEnabled: false\n});\nexport default ActivityMessage;","map":{"version":3,"sources":["../../../../../../src/elements/content-sidebar/activity-feed/common/activity-message/ActivityMessage.js"],"names":["React","noop","LoadingIndicator","formatTaggedMessage","ShowOriginalButton","TranslateButton","ActivityMessage","Component","translationEnabled","isLoading","isTranslation","prevProps","translatedTaggedMessage","translationFailed","props","prevTaggedMessage","prevTranslationFailed","setState","button","handleShowOriginal","handleTranslate","event","id","tagged_message","onTranslate","preventDefault","getUserProfileUrl","state","commentToDisplay","getButton"],"mappings":"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","sourcesContent":["// @flow\nimport * as React from 'react';\nimport noop from 'lodash/noop';\nimport LoadingIndicator from '../../../../../components/loading-indicator';\nimport formatTaggedMessage from '../../utils/formatTaggedMessage';\nimport ShowOriginalButton from './ShowOriginalButton';\nimport TranslateButton from './TranslateButton';\nimport type { GetProfileUrlCallback } from '../../../../common/flowTypes';\nimport './ActivityMessage.scss';\n\ntype Props = {\n    getUserProfileUrl?: GetProfileUrlCallback,\n    id: string,\n    onTranslate?: Function,\n    tagged_message: string,\n    translatedTaggedMessage?: string,\n    translationEnabled?: boolean,\n    translationFailed?: ?boolean,\n};\n\ntype State = {\n    isLoading?: boolean,\n    isTranslation?: boolean,\n};\n\nclass ActivityMessage extends React.Component<Props, State> {\n    static defaultProps = {\n        translationEnabled: false,\n    };\n\n    state = {\n        isLoading: false,\n        isTranslation: false,\n    };\n\n    componentDidUpdate(prevProps: Props): void {\n        const { translatedTaggedMessage, translationFailed } = this.props;\n        const { translatedTaggedMessage: prevTaggedMessage, translationFailed: prevTranslationFailed } = prevProps;\n\n        if (prevTaggedMessage === translatedTaggedMessage || prevTranslationFailed === translationFailed) {\n            return;\n        }\n\n        if (translatedTaggedMessage || translationFailed) {\n            this.setState({ isLoading: false });\n        }\n    }\n\n    getButton(isTranslation?: boolean): React.Node {\n        let button = null;\n        if (isTranslation) {\n            button = <ShowOriginalButton handleShowOriginal={this.handleShowOriginal} />;\n        } else {\n            button = <TranslateButton handleTranslate={this.handleTranslate} />;\n        }\n\n        return button;\n    }\n\n    handleTranslate = (event: SyntheticMouseEvent<>): void => {\n        const { id, tagged_message, onTranslate = noop, translatedTaggedMessage } = this.props;\n        if (!translatedTaggedMessage) {\n            this.setState({ isLoading: true });\n            onTranslate({ id, tagged_message });\n        }\n\n        this.setState({ isTranslation: true });\n        event.preventDefault();\n    };\n\n    handleShowOriginal = (event: SyntheticMouseEvent<>): void => {\n        this.setState({ isTranslation: false });\n        event.preventDefault();\n    };\n\n    render(): React.Node {\n        const { id, tagged_message, translatedTaggedMessage, translationEnabled, getUserProfileUrl } = this.props;\n        const { isLoading, isTranslation } = this.state;\n        const commentToDisplay =\n            translationEnabled && isTranslation && translatedTaggedMessage ? translatedTaggedMessage : tagged_message;\n        return isLoading ? (\n            <div className=\"bcs-ActivityMessageLoading\">\n                <LoadingIndicator size=\"small\" />\n            </div>\n        ) : (\n            <div className=\"bcs-ActivityMessage\">\n                {formatTaggedMessage(commentToDisplay, id, false, getUserProfileUrl)}\n                {translationEnabled ? this.getButton(isTranslation) : null}\n            </div>\n        );\n    }\n}\n\nexport default ActivityMessage;\n"]},"metadata":{},"sourceType":"module"}