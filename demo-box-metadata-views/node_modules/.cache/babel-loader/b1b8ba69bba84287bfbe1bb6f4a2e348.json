{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nimport classNames from 'classnames';\nimport getProp from 'lodash/get';\nimport noop from 'lodash/noop';\nimport * as React from 'react';\nimport ActivityError from '../common/activity-error';\nimport ActivityMessage from '../common/activity-message';\nimport ActivityTimestamp from '../common/activity-timestamp';\nimport AnnotationActivityLink from './AnnotationActivityLink';\nimport AnnotationActivityMenu from './AnnotationActivityMenu';\nimport Avatar from '../Avatar';\nimport Media from '../../../../components/media';\nimport messages from './messages';\nimport UserLink from '../common/user-link';\nimport { ACTIVITY_TARGETS } from '../../../common/interactionTargets';\nimport { PLACEHOLDER_USER } from '../../../../constants';\nimport './AnnotationActivity.scss';\nvar AnnotationActivity = function AnnotationActivity(_ref) {\n  var item = _ref.item,\n    getAvatarUrl = _ref.getAvatarUrl,\n    getUserProfileUrl = _ref.getUserProfileUrl,\n    isCurrentVersion = _ref.isCurrentVersion,\n    _ref$onDelete = _ref.onDelete,\n    onDelete = _ref$onDelete === void 0 ? noop : _ref$onDelete,\n    _ref$onSelect = _ref.onSelect,\n    onSelect = _ref$onSelect === void 0 ? noop : _ref$onSelect;\n  var created_at = item.created_at,\n    created_by = item.created_by,\n    description = item.description,\n    error = item.error,\n    file_version = item.file_version,\n    id = item.id,\n    isPending = item.isPending,\n    _item$permissions = item.permissions,\n    permissions = _item$permissions === void 0 ? {} : _item$permissions,\n    target = item.target;\n  var handleDeleteConfirm = function handleDeleteConfirm() {\n    onDelete({\n      id: id,\n      permissions: permissions\n    });\n  };\n  var handleOnSelect = function handleOnSelect() {\n    onSelect(item);\n  };\n  var createdAtTimestamp = new Date(created_at).getTime();\n  var createdByUser = created_by || PLACEHOLDER_USER;\n  var canDelete = permissions.can_delete;\n  var isFileVersionUnavailable = file_version === null;\n  var isMenuVisible = canDelete && !isPending;\n  var message = description && description.message || '';\n  var linkMessage = isCurrentVersion ? messages.annotationActivityPageItem : messages.annotationActivityVersionLink;\n  var linkValue = isCurrentVersion ? target.location.value : getProp(file_version, 'version_number');\n  var activityLinkMessage = isFileVersionUnavailable ? messages.annotationActivityVersionUnavailable : _objectSpread({}, linkMessage, {\n    values: {\n      number: linkValue\n    }\n  });\n  return React.createElement(\"div\", {\n    className: \"bcs-AnnotationActivity\",\n    \"data-resin-feature\": \"annotations\"\n  }, React.createElement(Media, {\n    className: classNames('bcs-AnnotationActivity-media', {\n      'bcs-is-pending': isPending || error\n    })\n  }, React.createElement(Media.Figure, null, React.createElement(Avatar, {\n    getAvatarUrl: getAvatarUrl,\n    user: createdByUser\n  })), React.createElement(Media.Body, null, isMenuVisible && React.createElement(AnnotationActivityMenu, {\n    canDelete: canDelete,\n    id: id,\n    onDeleteConfirm: handleDeleteConfirm\n  }), React.createElement(\"div\", {\n    className: \"bcs-AnnotationActivity-headline\"\n  }, React.createElement(UserLink, {\n    \"data-resin-target\": ACTIVITY_TARGETS.PROFILE,\n    getUserProfileUrl: getUserProfileUrl,\n    id: createdByUser.id,\n    name: createdByUser.name\n  })), React.createElement(\"div\", null, React.createElement(ActivityTimestamp, {\n    date: createdAtTimestamp\n  })), React.createElement(ActivityMessage, {\n    id: id,\n    tagged_message: message,\n    getUserProfileUrl: getUserProfileUrl\n  }), React.createElement(AnnotationActivityLink, {\n    \"data-resin-iscurrent\": isCurrentVersion,\n    \"data-resin-itemid\": id,\n    \"data-resin-target\": \"annotationLink\",\n    id: id,\n    isDisabled: isFileVersionUnavailable,\n    message: activityLinkMessage,\n    onClick: handleOnSelect\n  }))), error ? React.createElement(ActivityError, error) : null);\n};\nexport default AnnotationActivity;","map":{"version":3,"sources":["../../../../../src/elements/content-sidebar/activity-feed/annotations/AnnotationActivity.js"],"names":["classNames","getProp","noop","React","ActivityError","ActivityMessage","ActivityTimestamp","AnnotationActivityLink","AnnotationActivityMenu","Avatar","Media","messages","UserLink","ACTIVITY_TARGETS","PLACEHOLDER_USER","AnnotationActivity","item","getAvatarUrl","getUserProfileUrl","isCurrentVersion","onDelete","onSelect","created_at","created_by","description","error","file_version","id","isPending","permissions","target","handleDeleteConfirm","handleOnSelect","createdAtTimestamp","Date","getTime","createdByUser","canDelete","can_delete","isFileVersionUnavailable","isMenuVisible","message","linkMessage","annotationActivityPageItem","annotationActivityVersionLink","linkValue","location","value","activityLinkMessage","annotationActivityVersionUnavailable","values","number","PROFILE","name"],"mappings":"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","sourcesContent":["// @flow\nimport classNames from 'classnames';\nimport getProp from 'lodash/get';\nimport noop from 'lodash/noop';\nimport * as React from 'react';\nimport ActivityError from '../common/activity-error';\nimport ActivityMessage from '../common/activity-message';\nimport ActivityTimestamp from '../common/activity-timestamp';\nimport AnnotationActivityLink from './AnnotationActivityLink';\nimport AnnotationActivityMenu from './AnnotationActivityMenu';\nimport Avatar from '../Avatar';\nimport Media from '../../../../components/media';\nimport messages from './messages';\nimport UserLink from '../common/user-link';\nimport { ACTIVITY_TARGETS } from '../../../common/interactionTargets';\nimport { PLACEHOLDER_USER } from '../../../../constants';\nimport type { Annotation, AnnotationPermission } from '../../../../common/types/feed';\nimport type { GetAvatarUrlCallback, GetProfileUrlCallback } from '../../../common/flowTypes';\nimport type { User } from '../../../../common/types/core';\n\nimport './AnnotationActivity.scss';\n\ntype Props = {\n    currentUser?: User,\n    getAvatarUrl: GetAvatarUrlCallback,\n    getUserProfileUrl?: GetProfileUrlCallback,\n    isCurrentVersion: boolean,\n    item: Annotation,\n    onDelete?: ({ id: string, permissions: AnnotationPermission }) => any,\n    onSelect?: (annotation: Annotation) => any,\n};\n\nconst AnnotationActivity = ({\n    item,\n    getAvatarUrl,\n    getUserProfileUrl,\n    isCurrentVersion,\n    onDelete = noop,\n    onSelect = noop,\n}: Props) => {\n    const { created_at, created_by, description, error, file_version, id, isPending, permissions = {}, target } = item;\n\n    const handleDeleteConfirm = (): void => {\n        onDelete({ id, permissions });\n    };\n\n    const handleOnSelect = () => {\n        onSelect(item);\n    };\n\n    const createdAtTimestamp = new Date(created_at).getTime();\n    const createdByUser = created_by || PLACEHOLDER_USER;\n    const canDelete = permissions.can_delete;\n    const isFileVersionUnavailable = file_version === null;\n    const isMenuVisible = canDelete && !isPending;\n    const message = (description && description.message) || '';\n    const linkMessage = isCurrentVersion ? messages.annotationActivityPageItem : messages.annotationActivityVersionLink;\n    const linkValue = isCurrentVersion ? target.location.value : getProp(file_version, 'version_number');\n    const activityLinkMessage = isFileVersionUnavailable\n        ? messages.annotationActivityVersionUnavailable\n        : { ...linkMessage, values: { number: linkValue } };\n\n    return (\n        <div className=\"bcs-AnnotationActivity\" data-resin-feature=\"annotations\">\n            <Media\n                className={classNames('bcs-AnnotationActivity-media', {\n                    'bcs-is-pending': isPending || error,\n                })}\n            >\n                <Media.Figure>\n                    <Avatar getAvatarUrl={getAvatarUrl} user={createdByUser} />\n                </Media.Figure>\n                <Media.Body>\n                    {isMenuVisible && (\n                        <AnnotationActivityMenu canDelete={canDelete} id={id} onDeleteConfirm={handleDeleteConfirm} />\n                    )}\n                    <div className=\"bcs-AnnotationActivity-headline\">\n                        <UserLink\n                            data-resin-target={ACTIVITY_TARGETS.PROFILE}\n                            getUserProfileUrl={getUserProfileUrl}\n                            id={createdByUser.id}\n                            name={createdByUser.name}\n                        />\n                    </div>\n                    <div>\n                        <ActivityTimestamp date={createdAtTimestamp} />\n                    </div>\n                    <ActivityMessage id={id} tagged_message={message} getUserProfileUrl={getUserProfileUrl} />\n                    <AnnotationActivityLink\n                        data-resin-iscurrent={isCurrentVersion}\n                        data-resin-itemid={id}\n                        data-resin-target=\"annotationLink\"\n                        id={id}\n                        isDisabled={isFileVersionUnavailable}\n                        message={activityLinkMessage}\n                        onClick={handleOnSelect}\n                    />\n                </Media.Body>\n            </Media>\n            {/* $FlowFixMe */}\n            {error ? <ActivityError {...error} /> : null}\n        </div>\n    );\n};\n\nexport default AnnotationActivity;\n"]},"metadata":{},"sourceType":"module"}