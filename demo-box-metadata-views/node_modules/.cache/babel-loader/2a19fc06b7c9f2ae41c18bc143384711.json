{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nimport Browser from './BrowserUtils';\nimport Channel from './Channel';\nimport CONSTANTS from './constants';\nvar MAX_RETRY_ATTEMPTS = 2;\nvar ActiveXChannel = /*#__PURE__*/\nfunction (_Channel) {\n  _inherits(ActiveXChannel, _Channel);\n  function ActiveXChannel(appName, isSynchronous) {\n    var _this;\n    _classCallCheck(this, ActiveXChannel);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ActiveXChannel).call(this, appName));\n    _defineProperty(_assertThisInitialized(_this), \"executeOperation\", function () {\n      var operationType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var browserToComServerTimeoutMS = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var comServerToApplicationTimeoutSec = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      return new Promise(function (resolve, reject) {\n        var details = _this.buildDetailsObj(operationType, data, comServerToApplicationTimeoutSec);\n        var timeoutId = setTimeout(function () {\n          reject(new Error({\n            status_code: CONSTANTS.REQUEST_TIMEOUT_RESPONSE_CODE\n          }));\n        }, browserToComServerTimeoutMS);\n        _this.reqIdToPromiseMap.set(details.req_id, {\n          resolve: resolve,\n          rejectTimeout: timeoutId\n        });\n        _this.executeActiveXEvent({\n          detail: details\n        });\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"repairActiveXConnection\", function (payload) {\n      if (!Browser.isIEAndSpecificBrowserPluginSupported(CONSTANTS.BOX_TOOLS_PLUGIN_NAME)) {\n        return;\n      }\n      if (_this.retryAttempt >= MAX_RETRY_ATTEMPTS) {\n        return;\n      }\n      _this.retryAttempt += 1;\n      setTimeout(function () {\n        _this.executeActiveXEvent(payload);\n      }, 100);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"executeActiveXEvent\", function (payload) {\n      var activeX = _this.createActiveXObjectJSRef();\n      var hasExecuteSyncAPI = ('ExecuteSync' in activeX);\n      try {\n        if (_this.isSynchronous && hasExecuteSyncAPI) {\n          activeX.ExecuteSync(JSON.stringify(payload));\n        } else {\n          activeX.Execute(JSON.stringify(payload));\n        }\n      } catch (ex) {\n        _this.repairActiveXConnection(payload);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"createActiveXObjectJSRef\", function () {\n      var ActiveXObject = _this.window.ActiveXObject;\n      return new ActiveXObject(CONSTANTS.BOX_TOOLS_PLUGIN_NAME);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"setupActiveXCommunication\", function () {\n      if (!_this.isActiveXExtensionListenerAttached) {\n        // attach the event listener to App Extension output events\n        _this.document.addEventListener(CONSTANTS.OUTPUT_EVENT, _this.appExtensionEventResponseHandler);\n        _this.isActiveXExtensionListenerAttached = true;\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"tearDownActiveXCommunication\", function () {\n      if (_this.isActiveXExtensionListenerAttached) {\n        // remove the event listener for App Extension output events\n        _this.document.removeEventListener(CONSTANTS.OUTPUT_EVENT, _this.appExtensionEventResponseHandler);\n        _this.isActiveXExtensionListenerAttached = false;\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"appExtensionEventResponseHandler\", function (responseVal) {\n      if (_this.retryAttempt > 0) {\n        _this.retryAttempt = 0;\n      }\n      var response = typeof responseVal.detail === 'string' ? JSON.parse(responseVal.detail) : responseVal.detail;\n      if (_this.reqIdToPromiseMap.has(response.req_id)) {\n        var resolveObj = _this.reqIdToPromiseMap.get(response.req_id);\n        if (resolveObj) {\n          clearTimeout(resolveObj.rejectTimeout);\n          _this.reqIdToPromiseMap.delete(response.req_id);\n          var responseData = typeof response.com_server_response.data === 'string' ? JSON.parse(response.com_server_response.data) : response.com_server_response.data;\n          resolveObj.resolve(responseData);\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getComServerStatus\", function (browserToComServerTimeoutMS, comServerToApplicationTimeoutSec) {\n      return _this.executeOperation(CONSTANTS.OPERATION_STATUS, null, browserToComServerTimeoutMS, comServerToApplicationTimeoutSec);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"sendRequest\", function (data, browserToComServerTimeoutMS, comServerToApplicationTimeoutSec) {\n      return _this.executeOperation(CONSTANTS.OPERATION_REQUEST, data, browserToComServerTimeoutMS, comServerToApplicationTimeoutSec);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"sendCommand\", function (data, browserToComServerTimeoutMS, comServerToApplicationTimeoutSec) {\n      return _this.executeOperation(CONSTANTS.OPERATION_COMMAND, data, browserToComServerTimeoutMS, comServerToApplicationTimeoutSec);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"destroy\", function () {\n      _this.tearDownActiveXCommunication();\n    });\n    _this.isSynchronous = isSynchronous;\n    _this.channelName = CONSTANTS.ACTIVEX_CHANNEL_NAME;\n    _this.reqIdToPromiseMap = new Map();\n    _this.isActiveXExtensionListenerAttached = false;\n    _this.retryAttempt = 0;\n    _this.document = document;\n    _this.window = window;\n    _this.setupActiveXCommunication();\n    return _this;\n  }\n  return ActiveXChannel;\n}(Channel);\nexport { MAX_RETRY_ATTEMPTS };\nexport default ActiveXChannel;","map":{"version":3,"sources":["../../../src/api/box-edit/ActiveXChannel.js"],"names":["Browser","Channel","CONSTANTS","MAX_RETRY_ATTEMPTS","ActiveXChannel","appName","isSynchronous","channelName","ACTIVEX_CHANNEL_NAME","reqIdToPromiseMap","Map","isActiveXExtensionListenerAttached","retryAttempt","document","window","setupActiveXCommunication","operationType","data","browserToComServerTimeoutMS","comServerToApplicationTimeoutSec","Promise","resolve","reject","details","buildDetailsObj","timeoutId","setTimeout","Error","status_code","REQUEST_TIMEOUT_RESPONSE_CODE","set","req_id","rejectTimeout","executeActiveXEvent","detail","payload","isIEAndSpecificBrowserPluginSupported","BOX_TOOLS_PLUGIN_NAME","activeX","createActiveXObjectJSRef","hasExecuteSyncAPI","ExecuteSync","JSON","stringify","Execute","ex","repairActiveXConnection","ActiveXObject","addEventListener","OUTPUT_EVENT","appExtensionEventResponseHandler","removeEventListener","responseVal","response","parse","has","resolveObj","get","clearTimeout","delete","responseData","com_server_response","executeOperation","OPERATION_STATUS","OPERATION_REQUEST","OPERATION_COMMAND","tearDownActiveXCommunication"],"mappings":"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","sourcesContent":["// @flow\nimport Browser from './BrowserUtils';\nimport Channel from './Channel';\nimport CONSTANTS from './constants';\n\nconst MAX_RETRY_ATTEMPTS = 2;\n\nclass ActiveXChannel extends Channel {\n    isSynchronous: boolean;\n\n    isActiveXExtensionListenerAttached: boolean;\n\n    retryAttempt: number;\n\n    reqIdToPromiseMap: Map<string, Object>;\n\n    window: any;\n\n    document: Document;\n\n    constructor(appName: string, isSynchronous: boolean) {\n        super(appName);\n        this.isSynchronous = isSynchronous;\n        this.channelName = CONSTANTS.ACTIVEX_CHANNEL_NAME;\n        this.reqIdToPromiseMap = new Map();\n        this.isActiveXExtensionListenerAttached = false;\n        this.retryAttempt = 0;\n        this.document = document;\n        this.window = window;\n        this.setupActiveXCommunication();\n    }\n\n    executeOperation = (\n        operationType: string = '',\n        data: ?Object = {},\n        browserToComServerTimeoutMS: number = 0,\n        comServerToApplicationTimeoutSec: number = 0,\n    ): Promise<any> => {\n        return new Promise((resolve, reject) => {\n            const details = this.buildDetailsObj(operationType, data, comServerToApplicationTimeoutSec);\n\n            const timeoutId = setTimeout(() => {\n                reject(\n                    new Error({\n                        status_code: CONSTANTS.REQUEST_TIMEOUT_RESPONSE_CODE,\n                    }),\n                );\n            }, browserToComServerTimeoutMS);\n\n            this.reqIdToPromiseMap.set(details.req_id, {\n                resolve,\n                rejectTimeout: timeoutId,\n            });\n            this.executeActiveXEvent({ detail: details });\n        });\n    };\n\n    repairActiveXConnection = (payload: Object) => {\n        if (!Browser.isIEAndSpecificBrowserPluginSupported(CONSTANTS.BOX_TOOLS_PLUGIN_NAME)) {\n            return;\n        }\n\n        if (this.retryAttempt >= MAX_RETRY_ATTEMPTS) {\n            return;\n        }\n\n        this.retryAttempt += 1;\n\n        setTimeout(() => {\n            this.executeActiveXEvent(payload);\n        }, 100);\n    };\n\n    executeActiveXEvent = (payload: Object) => {\n        const activeX = this.createActiveXObjectJSRef();\n        const hasExecuteSyncAPI = 'ExecuteSync' in activeX;\n\n        try {\n            if (this.isSynchronous && hasExecuteSyncAPI) {\n                activeX.ExecuteSync(JSON.stringify(payload));\n            } else {\n                activeX.Execute(JSON.stringify(payload));\n            }\n        } catch (ex) {\n            this.repairActiveXConnection(payload);\n        }\n    };\n\n    createActiveXObjectJSRef = () => {\n        const { ActiveXObject } = this.window;\n        return new ActiveXObject(CONSTANTS.BOX_TOOLS_PLUGIN_NAME);\n    };\n\n    setupActiveXCommunication = () => {\n        if (!this.isActiveXExtensionListenerAttached) {\n            // attach the event listener to App Extension output events\n            this.document.addEventListener(CONSTANTS.OUTPUT_EVENT, this.appExtensionEventResponseHandler);\n            this.isActiveXExtensionListenerAttached = true;\n        }\n    };\n\n    tearDownActiveXCommunication = () => {\n        if (this.isActiveXExtensionListenerAttached) {\n            // remove the event listener for App Extension output events\n            this.document.removeEventListener(CONSTANTS.OUTPUT_EVENT, this.appExtensionEventResponseHandler);\n            this.isActiveXExtensionListenerAttached = false;\n        }\n    };\n\n    appExtensionEventResponseHandler = (responseVal: any) => {\n        if (this.retryAttempt > 0) {\n            this.retryAttempt = 0;\n        }\n\n        const response: Object =\n            typeof responseVal.detail === 'string' ? JSON.parse(responseVal.detail) : responseVal.detail;\n\n        if (this.reqIdToPromiseMap.has(response.req_id)) {\n            const resolveObj = this.reqIdToPromiseMap.get(response.req_id);\n            if (resolveObj) {\n                clearTimeout(resolveObj.rejectTimeout);\n                this.reqIdToPromiseMap.delete(response.req_id);\n\n                const responseData =\n                    typeof response.com_server_response.data === 'string'\n                        ? JSON.parse(response.com_server_response.data)\n                        : response.com_server_response.data;\n\n                resolveObj.resolve(responseData);\n            }\n        }\n    };\n\n    getComServerStatus = (browserToComServerTimeoutMS: number, comServerToApplicationTimeoutSec: number) => {\n        return this.executeOperation(\n            CONSTANTS.OPERATION_STATUS,\n            null,\n            browserToComServerTimeoutMS,\n            comServerToApplicationTimeoutSec,\n        );\n    };\n\n    sendRequest = (data: Object, browserToComServerTimeoutMS: number, comServerToApplicationTimeoutSec: number) => {\n        return this.executeOperation(\n            CONSTANTS.OPERATION_REQUEST,\n            data,\n            browserToComServerTimeoutMS,\n            comServerToApplicationTimeoutSec,\n        );\n    };\n\n    sendCommand = (data: Object, browserToComServerTimeoutMS: number, comServerToApplicationTimeoutSec: number) => {\n        return this.executeOperation(\n            CONSTANTS.OPERATION_COMMAND,\n            data,\n            browserToComServerTimeoutMS,\n            comServerToApplicationTimeoutSec,\n        );\n    };\n\n    destroy = () => {\n        this.tearDownActiveXCommunication();\n    };\n}\n\nexport { MAX_RETRY_ATTEMPTS };\nexport default ActiveXChannel;\n"]},"metadata":{},"sourceType":"module"}