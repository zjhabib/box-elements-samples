{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nimport merge from 'lodash/merge';\nimport { ERROR_CODE_CREATE_ANNOTATION, ERROR_CODE_DELETE_ANNOTATION, ERROR_CODE_FETCH_ANNOTATION, ERROR_CODE_FETCH_ANNOTATIONS, PERMISSION_CAN_CREATE_ANNOTATIONS, PERMISSION_CAN_DELETE, PERMISSION_CAN_VIEW_ANNOTATIONS } from '../constants';\nimport MarkerBasedApi from './MarkerBasedAPI';\nvar Annotations = /*#__PURE__*/\nfunction (_MarkerBasedApi) {\n  _inherits(Annotations, _MarkerBasedApi);\n  function Annotations() {\n    _classCallCheck(this, Annotations);\n    return _possibleConstructorReturn(this, _getPrototypeOf(Annotations).apply(this, arguments));\n  }\n  _createClass(Annotations, [{\n    key: \"getUrl\",\n    value: function getUrl() {\n      return \"\".concat(this.getBaseApiUrl(), \"/undoc/annotations\");\n    }\n  }, {\n    key: \"getUrlForId\",\n    value: function getUrlForId(annotationId) {\n      return \"\".concat(this.getUrl(), \"/\").concat(annotationId);\n    }\n  }, {\n    key: \"createAnnotation\",\n    value: function createAnnotation(fileId, fileVersionId, payload, permissions, successCallback, errorCallback) {\n      this.errorCode = ERROR_CODE_CREATE_ANNOTATION;\n      try {\n        this.checkApiCallValidity(PERMISSION_CAN_CREATE_ANNOTATIONS, permissions, fileId);\n      } catch (e) {\n        errorCallback(e, this.errorCode);\n        return;\n      }\n      var defaults = {\n        description: {\n          type: 'reply'\n        },\n        file_version: {\n          id: fileVersionId,\n          type: 'file_version'\n        },\n        status: 'open',\n        type: 'annotation'\n      };\n      this.post({\n        id: fileId,\n        data: {\n          data: merge(defaults, payload)\n        },\n        errorCallback: errorCallback,\n        successCallback: successCallback,\n        url: this.getUrl()\n      });\n    }\n  }, {\n    key: \"deleteAnnotation\",\n    value: function deleteAnnotation(fileId, annotationId, permissions, successCallback, errorCallback) {\n      this.errorCode = ERROR_CODE_DELETE_ANNOTATION;\n      try {\n        this.checkApiCallValidity(PERMISSION_CAN_DELETE, permissions, fileId);\n      } catch (e) {\n        errorCallback(e, this.errorCode);\n        return;\n      }\n      this.delete({\n        id: fileId,\n        errorCallback: errorCallback,\n        successCallback: successCallback,\n        url: this.getUrlForId(annotationId)\n      });\n    }\n  }, {\n    key: \"getAnnotation\",\n    value: function getAnnotation(fileId, annotationId, permissions, successCallback, errorCallback) {\n      this.errorCode = ERROR_CODE_FETCH_ANNOTATION;\n      try {\n        this.checkApiCallValidity(PERMISSION_CAN_VIEW_ANNOTATIONS, permissions, fileId);\n      } catch (e) {\n        errorCallback(e, this.errorCode);\n        return;\n      }\n      this.get({\n        id: fileId,\n        errorCallback: errorCallback,\n        successCallback: successCallback,\n        url: this.getUrlForId(annotationId)\n      });\n    }\n  }, {\n    key: \"getAnnotations\",\n    value: function getAnnotations(fileId, fileVersionId, permissions, successCallback, errorCallback, limit, shouldFetchAll) {\n      this.errorCode = ERROR_CODE_FETCH_ANNOTATIONS;\n      try {\n        this.checkApiCallValidity(PERMISSION_CAN_VIEW_ANNOTATIONS, permissions, fileId);\n      } catch (e) {\n        errorCallback(e, this.errorCode);\n        return;\n      }\n      this.markerGet({\n        id: fileId,\n        errorCallback: errorCallback,\n        limit: limit,\n        requestData: {\n          file_id: fileId,\n          file_version_id: fileVersionId\n        },\n        shouldFetchAll: shouldFetchAll,\n        successCallback: successCallback\n      });\n    }\n  }]);\n  return Annotations;\n}(MarkerBasedApi);\nexport { Annotations as default };","map":{"version":3,"sources":["../../src/api/Annotations.js"],"names":["merge","ERROR_CODE_CREATE_ANNOTATION","ERROR_CODE_DELETE_ANNOTATION","ERROR_CODE_FETCH_ANNOTATION","ERROR_CODE_FETCH_ANNOTATIONS","PERMISSION_CAN_CREATE_ANNOTATIONS","PERMISSION_CAN_DELETE","PERMISSION_CAN_VIEW_ANNOTATIONS","MarkerBasedApi","Annotations","getBaseApiUrl","annotationId","getUrl","fileId","fileVersionId","payload","permissions","successCallback","errorCallback","errorCode","checkApiCallValidity","e","defaults","description","type","file_version","id","status","post","data","url","delete","getUrlForId","get","limit","shouldFetchAll","markerGet","requestData","file_id","file_version_id"],"mappings":"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","sourcesContent":["// @flow\nimport merge from 'lodash/merge';\nimport {\n    ERROR_CODE_CREATE_ANNOTATION,\n    ERROR_CODE_DELETE_ANNOTATION,\n    ERROR_CODE_FETCH_ANNOTATION,\n    ERROR_CODE_FETCH_ANNOTATIONS,\n    PERMISSION_CAN_CREATE_ANNOTATIONS,\n    PERMISSION_CAN_DELETE,\n    PERMISSION_CAN_VIEW_ANNOTATIONS,\n} from '../constants';\nimport MarkerBasedApi from './MarkerBasedAPI';\nimport type {\n    Annotation,\n    AnnotationPermission,\n    Annotations as AnnotationsType,\n    NewAnnotation,\n} from '../common/types/annotations';\nimport type { BoxItemPermission } from '../common/types/core';\nimport type { ElementsXhrError } from '../common/types/api';\n\nexport default class Annotations extends MarkerBasedApi {\n    getUrl() {\n        return `${this.getBaseApiUrl()}/undoc/annotations`;\n    }\n\n    getUrlForId(annotationId: string) {\n        return `${this.getUrl()}/${annotationId}`;\n    }\n\n    createAnnotation(\n        fileId: string,\n        fileVersionId: string,\n        payload: NewAnnotation,\n        permissions: BoxItemPermission,\n        successCallback: (annotation: Annotation) => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n    ): void {\n        this.errorCode = ERROR_CODE_CREATE_ANNOTATION;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_CREATE_ANNOTATIONS, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        const defaults = {\n            description: {\n                type: 'reply',\n            },\n            file_version: {\n                id: fileVersionId,\n                type: 'file_version',\n            },\n            status: 'open',\n            type: 'annotation',\n        };\n\n        this.post({\n            id: fileId,\n            data: {\n                data: merge(defaults, payload),\n            },\n            errorCallback,\n            successCallback,\n            url: this.getUrl(),\n        });\n    }\n\n    deleteAnnotation(\n        fileId: string,\n        annotationId: string,\n        permissions: AnnotationPermission,\n        successCallback: () => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n    ): void {\n        this.errorCode = ERROR_CODE_DELETE_ANNOTATION;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_DELETE, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        this.delete({\n            id: fileId,\n            errorCallback,\n            successCallback,\n            url: this.getUrlForId(annotationId),\n        });\n    }\n\n    getAnnotation(\n        fileId: string,\n        annotationId: string,\n        permissions: BoxItemPermission,\n        successCallback: (annotation: Annotation) => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n    ): void {\n        this.errorCode = ERROR_CODE_FETCH_ANNOTATION;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_VIEW_ANNOTATIONS, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        this.get({\n            id: fileId,\n            errorCallback,\n            successCallback,\n            url: this.getUrlForId(annotationId),\n        });\n    }\n\n    getAnnotations(\n        fileId: string,\n        fileVersionId?: string,\n        permissions: BoxItemPermission,\n        successCallback: (annotations: AnnotationsType) => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n        limit?: number,\n        shouldFetchAll?: boolean,\n    ): void {\n        this.errorCode = ERROR_CODE_FETCH_ANNOTATIONS;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_VIEW_ANNOTATIONS, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        this.markerGet({\n            id: fileId,\n            errorCallback,\n            limit,\n            requestData: {\n                file_id: fileId,\n                file_version_id: fileVersionId,\n            },\n            shouldFetchAll,\n            successCallback,\n        });\n    }\n}\n"]},"metadata":{},"sourceType":"module"}