{"version":3,"sources":["../../src/api/Annotations.js"],"names":["merge","ERROR_CODE_CREATE_ANNOTATION","ERROR_CODE_DELETE_ANNOTATION","ERROR_CODE_FETCH_ANNOTATION","ERROR_CODE_FETCH_ANNOTATIONS","PERMISSION_CAN_CREATE_ANNOTATIONS","PERMISSION_CAN_DELETE","PERMISSION_CAN_VIEW_ANNOTATIONS","MarkerBasedApi","Annotations","getBaseApiUrl","annotationId","getUrl","fileId","fileVersionId","payload","permissions","successCallback","errorCallback","errorCode","checkApiCallValidity","e","defaults","description","type","file_version","id","status","post","data","url","delete","getUrlForId","get","limit","shouldFetchAll","markerGet","requestData","file_id","file_version_id"],"mappings":"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","sourcesContent":["// @flow\nimport merge from 'lodash/merge';\nimport {\n    ERROR_CODE_CREATE_ANNOTATION,\n    ERROR_CODE_DELETE_ANNOTATION,\n    ERROR_CODE_FETCH_ANNOTATION,\n    ERROR_CODE_FETCH_ANNOTATIONS,\n    PERMISSION_CAN_CREATE_ANNOTATIONS,\n    PERMISSION_CAN_DELETE,\n    PERMISSION_CAN_VIEW_ANNOTATIONS,\n} from '../constants';\nimport MarkerBasedApi from './MarkerBasedAPI';\nimport type {\n    Annotation,\n    AnnotationPermission,\n    Annotations as AnnotationsType,\n    NewAnnotation,\n} from '../common/types/annotations';\nimport type { BoxItemPermission } from '../common/types/core';\nimport type { ElementsXhrError } from '../common/types/api';\n\nexport default class Annotations extends MarkerBasedApi {\n    getUrl() {\n        return `${this.getBaseApiUrl()}/undoc/annotations`;\n    }\n\n    getUrlForId(annotationId: string) {\n        return `${this.getUrl()}/${annotationId}`;\n    }\n\n    createAnnotation(\n        fileId: string,\n        fileVersionId: string,\n        payload: NewAnnotation,\n        permissions: BoxItemPermission,\n        successCallback: (annotation: Annotation) => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n    ): void {\n        this.errorCode = ERROR_CODE_CREATE_ANNOTATION;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_CREATE_ANNOTATIONS, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        const defaults = {\n            description: {\n                type: 'reply',\n            },\n            file_version: {\n                id: fileVersionId,\n                type: 'file_version',\n            },\n            status: 'open',\n            type: 'annotation',\n        };\n\n        this.post({\n            id: fileId,\n            data: {\n                data: merge(defaults, payload),\n            },\n            errorCallback,\n            successCallback,\n            url: this.getUrl(),\n        });\n    }\n\n    deleteAnnotation(\n        fileId: string,\n        annotationId: string,\n        permissions: AnnotationPermission,\n        successCallback: () => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n    ): void {\n        this.errorCode = ERROR_CODE_DELETE_ANNOTATION;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_DELETE, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        this.delete({\n            id: fileId,\n            errorCallback,\n            successCallback,\n            url: this.getUrlForId(annotationId),\n        });\n    }\n\n    getAnnotation(\n        fileId: string,\n        annotationId: string,\n        permissions: BoxItemPermission,\n        successCallback: (annotation: Annotation) => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n    ): void {\n        this.errorCode = ERROR_CODE_FETCH_ANNOTATION;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_VIEW_ANNOTATIONS, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        this.get({\n            id: fileId,\n            errorCallback,\n            successCallback,\n            url: this.getUrlForId(annotationId),\n        });\n    }\n\n    getAnnotations(\n        fileId: string,\n        fileVersionId?: string,\n        permissions: BoxItemPermission,\n        successCallback: (annotations: AnnotationsType) => void,\n        errorCallback: (e: ElementsXhrError, code: string) => void,\n        limit?: number,\n        shouldFetchAll?: boolean,\n    ): void {\n        this.errorCode = ERROR_CODE_FETCH_ANNOTATIONS;\n\n        try {\n            this.checkApiCallValidity(PERMISSION_CAN_VIEW_ANNOTATIONS, permissions, fileId);\n        } catch (e) {\n            errorCallback(e, this.errorCode);\n            return;\n        }\n\n        this.markerGet({\n            id: fileId,\n            errorCallback,\n            limit,\n            requestData: {\n                file_id: fileId,\n                file_version_id: fileVersionId,\n            },\n            shouldFetchAll,\n            successCallback,\n        });\n    }\n}\n"],"file":"Annotations.js"}