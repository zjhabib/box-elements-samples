{"version":3,"sources":["../../../../../src/elements/content-sidebar/activity-feed/annotations/AnnotationActivity.js"],"names":["classNames","getProp","noop","React","ActivityError","ActivityMessage","ActivityTimestamp","AnnotationActivityLink","AnnotationActivityMenu","Avatar","Media","messages","UserLink","ACTIVITY_TARGETS","PLACEHOLDER_USER","AnnotationActivity","item","getAvatarUrl","getUserProfileUrl","isCurrentVersion","onDelete","onSelect","created_at","created_by","description","error","file_version","id","isPending","permissions","target","handleDeleteConfirm","handleOnSelect","createdAtTimestamp","Date","getTime","createdByUser","canDelete","can_delete","isFileVersionUnavailable","isMenuVisible","message","linkMessage","annotationActivityPageItem","annotationActivityVersionLink","linkValue","location","value","activityLinkMessage","annotationActivityVersionUnavailable","values","number","PROFILE","name"],"mappings":"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","sourcesContent":["// @flow\nimport classNames from 'classnames';\nimport getProp from 'lodash/get';\nimport noop from 'lodash/noop';\nimport * as React from 'react';\nimport ActivityError from '../common/activity-error';\nimport ActivityMessage from '../common/activity-message';\nimport ActivityTimestamp from '../common/activity-timestamp';\nimport AnnotationActivityLink from './AnnotationActivityLink';\nimport AnnotationActivityMenu from './AnnotationActivityMenu';\nimport Avatar from '../Avatar';\nimport Media from '../../../../components/media';\nimport messages from './messages';\nimport UserLink from '../common/user-link';\nimport { ACTIVITY_TARGETS } from '../../../common/interactionTargets';\nimport { PLACEHOLDER_USER } from '../../../../constants';\nimport type { Annotation, AnnotationPermission } from '../../../../common/types/feed';\nimport type { GetAvatarUrlCallback, GetProfileUrlCallback } from '../../../common/flowTypes';\nimport type { User } from '../../../../common/types/core';\n\nimport './AnnotationActivity.scss';\n\ntype Props = {\n    currentUser?: User,\n    getAvatarUrl: GetAvatarUrlCallback,\n    getUserProfileUrl?: GetProfileUrlCallback,\n    isCurrentVersion: boolean,\n    item: Annotation,\n    onDelete?: ({ id: string, permissions: AnnotationPermission }) => any,\n    onSelect?: (annotation: Annotation) => any,\n};\n\nconst AnnotationActivity = ({\n    item,\n    getAvatarUrl,\n    getUserProfileUrl,\n    isCurrentVersion,\n    onDelete = noop,\n    onSelect = noop,\n}: Props) => {\n    const { created_at, created_by, description, error, file_version, id, isPending, permissions = {}, target } = item;\n\n    const handleDeleteConfirm = (): void => {\n        onDelete({ id, permissions });\n    };\n\n    const handleOnSelect = () => {\n        onSelect(item);\n    };\n\n    const createdAtTimestamp = new Date(created_at).getTime();\n    const createdByUser = created_by || PLACEHOLDER_USER;\n    const canDelete = permissions.can_delete;\n    const isFileVersionUnavailable = file_version === null;\n    const isMenuVisible = canDelete && !isPending;\n    const message = (description && description.message) || '';\n    const linkMessage = isCurrentVersion ? messages.annotationActivityPageItem : messages.annotationActivityVersionLink;\n    const linkValue = isCurrentVersion ? target.location.value : getProp(file_version, 'version_number');\n    const activityLinkMessage = isFileVersionUnavailable\n        ? messages.annotationActivityVersionUnavailable\n        : { ...linkMessage, values: { number: linkValue } };\n\n    return (\n        <div className=\"bcs-AnnotationActivity\" data-resin-feature=\"annotations\">\n            <Media\n                className={classNames('bcs-AnnotationActivity-media', {\n                    'bcs-is-pending': isPending || error,\n                })}\n            >\n                <Media.Figure>\n                    <Avatar getAvatarUrl={getAvatarUrl} user={createdByUser} />\n                </Media.Figure>\n                <Media.Body>\n                    {isMenuVisible && (\n                        <AnnotationActivityMenu canDelete={canDelete} id={id} onDeleteConfirm={handleDeleteConfirm} />\n                    )}\n                    <div className=\"bcs-AnnotationActivity-headline\">\n                        <UserLink\n                            data-resin-target={ACTIVITY_TARGETS.PROFILE}\n                            getUserProfileUrl={getUserProfileUrl}\n                            id={createdByUser.id}\n                            name={createdByUser.name}\n                        />\n                    </div>\n                    <div>\n                        <ActivityTimestamp date={createdAtTimestamp} />\n                    </div>\n                    <ActivityMessage id={id} tagged_message={message} getUserProfileUrl={getUserProfileUrl} />\n                    <AnnotationActivityLink\n                        data-resin-iscurrent={isCurrentVersion}\n                        data-resin-itemid={id}\n                        data-resin-target=\"annotationLink\"\n                        id={id}\n                        isDisabled={isFileVersionUnavailable}\n                        message={activityLinkMessage}\n                        onClick={handleOnSelect}\n                    />\n                </Media.Body>\n            </Media>\n            {/* $FlowFixMe */}\n            {error ? <ActivityError {...error} /> : null}\n        </div>\n    );\n};\n\nexport default AnnotationActivity;\n"],"file":"AnnotationActivity.js"}