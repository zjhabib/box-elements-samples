{"version":3,"sources":["../../../../../src/elements/content-sidebar/activity-feed/activity-feed/ActiveState.js"],"names":["React","getProp","ActivityItem","AppActivity","AnnotationActivity","Comment","TaskNew","Version","CollapsedVersion","withErrorHandling","ActiveState","activeFeedEntryId","activeFeedEntryType","activeFeedItemRef","approverSelectorContacts","currentFileVersionId","currentUser","items","mentionSelectorContacts","getMentionWithQuery","onAnnotationDelete","onAnnotationSelect","onAppActivityDelete","onCommentDelete","onCommentEdit","onTaskDelete","onTaskEdit","onTaskView","onTaskAssignmentUpdate","onTaskModalClose","onVersionInfo","translations","getApproverWithQuery","getAvatarUrl","getUserProfileUrl","activeEntry","find","id","type","map","item","isFocused","refValue","undefined","itemFileVersionId","can_delete","permissions","can_edit","versions","ActiveStateComponent"],"mappings":"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","sourcesContent":["/**\n * @flow\n * @file Active state component for Activity Feed\n */\nimport * as React from 'react';\nimport getProp from 'lodash/get';\nimport ActivityItem from './ActivityItem';\nimport AppActivity from '../app-activity';\nimport AnnotationActivity from '../annotations';\nimport Comment from '../comment';\nimport TaskNew from '../task-new';\nimport Version, { CollapsedVersion } from '../version';\nimport withErrorHandling from '../../withErrorHandling';\nimport type {\n    Annotation,\n    AnnotationPermission,\n    FeedItem,\n    FeedItems,\n    FocusableFeedItemType,\n} from '../../../../common/types/feed';\nimport type { SelectorItems, User } from '../../../../common/types/core';\nimport type { GetAvatarUrlCallback, GetProfileUrlCallback } from '../../../common/flowTypes';\nimport type { Translations } from '../../flowTypes';\n\ntype Props = {\n    activeFeedEntryId?: string,\n    activeFeedEntryType?: FocusableFeedItemType,\n    activeFeedItemRef: { current: null | HTMLElement },\n    approverSelectorContacts?: SelectorItems<>,\n    currentFileVersionId: string,\n    currentUser?: User,\n    getApproverWithQuery?: Function,\n    getAvatarUrl: GetAvatarUrlCallback,\n    getMentionWithQuery?: Function,\n    getUserProfileUrl?: GetProfileUrlCallback,\n    items: FeedItems,\n    mentionSelectorContacts?: SelectorItems<>,\n    onAnnotationDelete?: ({ id: string, permissions: AnnotationPermission }) => void,\n    onAnnotationSelect?: (annotation: Annotation) => void,\n    onAppActivityDelete?: Function,\n    onCommentDelete?: Function,\n    onCommentEdit?: Function,\n    onTaskAssignmentUpdate?: Function,\n    onTaskDelete?: Function,\n    onTaskEdit?: Function,\n    onTaskModalClose?: Function,\n    onTaskView?: Function,\n    onVersionInfo?: Function,\n    translations?: Translations,\n};\n\nconst ActiveState = ({\n    activeFeedEntryId,\n    activeFeedEntryType,\n    activeFeedItemRef,\n    approverSelectorContacts,\n    currentFileVersionId,\n    currentUser,\n    items,\n    mentionSelectorContacts,\n    getMentionWithQuery,\n    onAnnotationDelete,\n    onAnnotationSelect,\n    onAppActivityDelete,\n    onCommentDelete,\n    onCommentEdit,\n    onTaskDelete,\n    onTaskEdit,\n    onTaskView,\n    onTaskAssignmentUpdate,\n    onTaskModalClose,\n    onVersionInfo,\n    translations,\n    getApproverWithQuery,\n    getAvatarUrl,\n    getUserProfileUrl,\n}: Props): React.Node => {\n    const activeEntry = items.find(({ id, type }) => id === activeFeedEntryId && type === activeFeedEntryType);\n\n    return (\n        <ul className=\"bcs-activity-feed-active-state\">\n            {items.map((item: FeedItem) => {\n                const isFocused = item === activeEntry;\n                const refValue = isFocused ? activeFeedItemRef : undefined;\n                const itemFileVersionId = getProp(item, 'file_version.id');\n\n                switch (item.type) {\n                    case 'comment':\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-comment\"\n                                data-testid=\"comment\"\n                                isFocused={isFocused}\n                                ref={refValue}\n                            >\n                                <Comment\n                                    {...item}\n                                    currentUser={currentUser}\n                                    getAvatarUrl={getAvatarUrl}\n                                    getMentionWithQuery={getMentionWithQuery}\n                                    getUserProfileUrl={getUserProfileUrl}\n                                    mentionSelectorContacts={mentionSelectorContacts}\n                                    onDelete={onCommentDelete}\n                                    onEdit={onCommentEdit}\n                                    permissions={{\n                                        can_delete: getProp(item.permissions, 'can_delete', false),\n                                        can_edit: getProp(item.permissions, 'can_edit', false),\n                                    }}\n                                    translations={translations}\n                                />\n                            </ActivityItem>\n                        );\n                    case 'task':\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-task-new\"\n                                data-testid=\"task\"\n                                isFocused={isFocused}\n                                ref={refValue}\n                            >\n                                <TaskNew\n                                    {...item}\n                                    approverSelectorContacts={approverSelectorContacts}\n                                    currentUser={currentUser}\n                                    getApproverWithQuery={getApproverWithQuery}\n                                    getAvatarUrl={getAvatarUrl}\n                                    getUserProfileUrl={getUserProfileUrl}\n                                    onAssignmentUpdate={onTaskAssignmentUpdate}\n                                    onDelete={onTaskDelete}\n                                    onEdit={onTaskEdit}\n                                    onView={onTaskView}\n                                    onModalClose={onTaskModalClose}\n                                    translations={translations}\n                                />\n                            </ActivityItem>\n                        );\n                    case 'file_version':\n                        return (\n                            <ActivityItem key={item.type + item.id} className=\"bcs-version-item\" data-testid=\"version\">\n                                {item.versions ? (\n                                    // $FlowFixMe\n                                    <CollapsedVersion {...item} onInfo={onVersionInfo} />\n                                ) : (\n                                    // $FlowFixMe\n                                    <Version {...item} onInfo={onVersionInfo} />\n                                )}\n                            </ActivityItem>\n                        );\n                    case 'app_activity':\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-app-activity\"\n                                data-testid=\"app-activity\"\n                            >\n                                <AppActivity currentUser={currentUser} onDelete={onAppActivityDelete} {...item} />\n                            </ActivityItem>\n                        );\n                    case 'annotation':\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-annotation-activity\"\n                                data-testid=\"annotation-activity\"\n                                isFocused={isFocused}\n                                ref={refValue}\n                            >\n                                <AnnotationActivity\n                                    currentUser={currentUser}\n                                    getAvatarUrl={getAvatarUrl}\n                                    getUserProfileUrl={getUserProfileUrl}\n                                    isCurrentVersion={currentFileVersionId === itemFileVersionId}\n                                    item={item}\n                                    mentionSelectorContacts={mentionSelectorContacts}\n                                    onDelete={onAnnotationDelete}\n                                    onSelect={onAnnotationSelect}\n                                />\n                            </ActivityItem>\n                        );\n                    default:\n                        return null;\n                }\n            })}\n        </ul>\n    );\n};\n\nexport { ActiveState as ActiveStateComponent };\nexport default withErrorHandling(ActiveState);\n"],"file":"ActiveState.js"}